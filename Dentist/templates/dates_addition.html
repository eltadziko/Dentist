{% extends 'base.html' %}

{% block css %}
	{{ block.super }}
	<style type="text/css">
		/* begin: jQuery UI Datepicker moving pixels fix */
		table.ui-datepicker-calendar {border-collapse: separate;}
		.ui-datepicker-calendar td {border: 1px solid transparent;}
		/* end: jQuery UI Datepicker moving pixels fix */
		
		/* begin: jQuery UI Datepicker emphasis on selected dates */
		.ui-datepicker .ui-datepicker-calendar .ui-state-highlight a {
		background: #743620 none; /* a color that fits the widget theme */
		color: white; /* a color that is readeable with the color above */
		}
		/* end: jQuery UI Datepicker emphasis on selected dates */
	</style>
{% endblock %}

{% block javascript %}
	{{ block.super }}
	<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
	<script src="{{ MEDIA_URL }}/js/datepicker.js" ></script>
	<script src="{{ MEDIA_URL }}/js/jquery-ui.multidatespicker.js" ></script>
	<script>
	$(document).ready(function() {
		 $.datepicker.setDefaults($.datepicker.regional['PL']);
		 $( "#id_begin" ).datepicker( {
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            minDate: "0",
            onClose: function( selectedDate ) {
                $( "#id_end" ).datepicker( "option", "minDate", selectedDate );
                /*$( "#id_exclude" ).datepicker( "option", "minDate", selectedDate );*/
            }
        });      
		 $( "#id_end" ).datepicker( {
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            minDate: "0",
            onClose: function( selectedDate ) {
                $( "#id_begin" ).datepicker( "option", "maxDate", selectedDate );
                /*$( "#id_exclude" ).datepicker( "option", "maxDate", selectedDate );*/
            }
        });
        $( "#id_exclude" ).multiDatesPicker({
        	defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
			minDate: "0",
			/* onClose: function( selectedDate ) {
				var ble = $( "#id_begin" ).val();
				var ble2 = $( "#id_end" ).val();
			alert(ble+" "+ble2);
                $( this ).datepicker( "option", "minDate", ble);
                $( this ).datepicker( "option", "maxDate", ble2 );
            }*/
		});
		 $("#id_office").change(function() {
			$.post('/dates_addition/',
			{ office: $(this).val(),
			  csrfmiddlewaretoken: '{{ csrf_token }}' },
			function(data) { 
				$('#content').html(data); 
			});
		 	return false;
		 });
		 
		 $("select[name=dentist_man]").change(function() {
			$.post('/dates_addition/',
			{ office: $('#id_office').val(),
			  dentist_man: $(this).val(),
			  csrfmiddlewaretoken: '{{ csrf_token }}' },
			function(data) { 
				$('#content').html(data); 
			});
		 	return false;
		 });		 
	});
	</script>
{% endblock %}

{% block right_column %}
<div id="forms">
<form action="{% url views.dates_addition %}" method="post"> {% csrf_token %}
	{% if form.non_field_errors %}
       	<div class="error">
		    {% for error in form.non_field_errors %}
		        <strong>{{ error|escape }} </strong>
			{% endfor %}
		</div>
	{% endif %}
	
	{% for field in form %}
		<div class="fieldWrapper">
	        {% if field.errors %}
	        	<div class="error">
			    {% for error in field.errors %}
			        <strong>{{ error|escape }} </strong>
			    {% endfor %}
			    </div>
			{% endif %}
	        {{ field.label_tag }} 
	        {{ field }}
	    </div>
    {% endfor %}
    
	<p><input id="id_generate_submit" name="generate_submit" type="submit" value="Generuj" /></p>
</form>
</div>
{% endblock %}